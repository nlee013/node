//Express 기본 모듈 불러오기
require("dotenv").config();
var express = require("express");
var http = require("http");
var path = require("path");

var serveStatic = require("serve-static");//특정 폴더를 패스로 접근

//express 객체 생성
var app = express(); //app가 express

app.set("port", process.env.PORT);

app.use(express.urlencoded({extended:false}));

app.use("/public", serveStatic(path.join(__dirname, "public"))); //가상주소: /public

//router 객체 추가---------------------------------------------------

var router = express.Router();

//무조건 실행시키는 것이 아닌 router를 추가하고 아래는 특정 조건이 올 때만 실행시키게 함

//middleware 객체(use) 생성---------------------------------------
//app.use(function (req, res, next) {//next는 사용자 정의. 다음으로 넘어간다고 해서 next로 써준 것

router.route("/process/login").post(function (req, res, next) {
	
	console.log("/process/login 처리..");
	
	var paramId = req.body.id;
	var paramPwd = req.body.pwd;
	
	res.writeHead("200", {"Content-type":"text/html;charset=utf-8"});
	res.write("<h1>Express Server에서 응답한 결과입니다.</h1>");
	res.write("<div><p>ID:" + paramId + "</p></div>");
	res.write("<div><p>PWD:" + paramPwd + "</p></div>");
	res.end();

});
//---------------------------------------------------------

http.createServer(app).listen(app.get("port"), function(){

	console.log("Express Server를 시작했습니다: " + app.get("port"));//3000이 찍힌것은 env에서 가져온것
});
